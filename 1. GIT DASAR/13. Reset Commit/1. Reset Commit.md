# ğŸ”„ Git Reset Commit

## ğŸ“š Pengenalan

Dalam perjalanan belajar Git, terkadang kita membuat kesalahan saat melakukan commit. Mungkin kita sudah terlanjur mengirim perubahan ke repository padahal belum siap, atau kita ingin membatalkan beberapa commit sebelumnya.

**Jangan khawatir!** Git menyediakan fitur `git reset` yang memungkinkan kita untuk mundur ke commit sebelumnya dan memperbaiki kesalahan tersebut.

---

## ğŸ¯ Apa itu Reset Commit?

Reset commit adalah mekanisme di Git untuk **menggeser HEAD pointer** ke posisi commit yang kita inginkan. Dengan melakukan ini, perubahan dari commit yang dibatalkan akan dipindahkan ke salah satu tempat berikut:
- Staging Index (untuk di-commit ulang)
- Working Directory (untuk diedit ulang)
- Atau dihapus sepenuhnya

**Penting:** Commit selanjutnya akan dilakukan pada posisi HEAD yang baru.

---

## ğŸ“– Diagram Git Reset

Mari kita lihat bagaimana HEAD pointer bergerak saat melakukan reset:

```
git reset <mode> 2f5t...

1239... â†’ 2395... â†’ 3f56... â†’ 4567... â†’ 5678...
                â†‘                           â†‘
              HEAD (sebelum)              HEAD (setelah)
         
Perhatian: HEAD berpindah dari 3f56... ke 2395...
```

**Penjelasan:**
- Garis panah menunjukkan urutan commit dalam repository
- HEAD pointer menunjukkan posisi kita saat ini
- Ketika kita melakukan reset, HEAD akan berpindah ke commit yang kita tentukan
- Commit yang berada setelah posisi baru HEAD tidak akan hilang, hanya tidak bisa diakses langsung

---

## ğŸ› ï¸ Mode-Mode Git Reset

Git memiliki **tiga mode utama** untuk melakukan reset. Setiap mode menentukan **ke mana perubahan akan dipindahkan**:

### 1ï¸âƒ£ Mode `--soft` (Lembut)

```
git reset --soft <hash>
```

**Apa yang terjadi:**
- âœï¸ HEAD pointer **dipindahkan** ke commit yang dituju
- ğŸ“¦ Perubahan dari commit yang dibatalkan **dipindahkan ke Staging Index** (siap untuk di-commit)
- ğŸ“ **Working Directory tetap tidak berubah**

**Analogi:**
Seperti mengambil barang dari tas (commit) dan meletakkannya di meja kasir (staging), tetapi folder Anda tetap seperti semula.

**Kapan digunakan:**
- Ketika Anda ingin **membatalkan commit tetapi menjaga perubahannya siap untuk di-commit ulang**
- Saat menulis commit message yang salah dan ingin memperbaikinya
- Saat ingin menggabungkan beberapa commit menjadi satu

---

### 2ï¸âƒ£ Mode `--mixed` (Sedang - Mode Default)

```
git reset --mixed <hash>
# Atau hanya
git reset <hash>
```

**Apa yang terjadi:**
- âœï¸ HEAD pointer **dipindahkan** ke commit yang dituju
- ğŸ“¦ Staging Index **dikosongkan** (tidak ada yang siap di-commit)
- ğŸ“ Perubahan dari commit yang dibatalkan **dipindahkan ke Working Directory** (bisa dilihat dan diedit di folder)

**Analogi:**
Seperti mengambil barang dari tas (commit) dan langsung meletakkannya di lantai ruangan Anda (working directory), sehingga Anda bisa melihat dan mengeditnya.

**Kapan digunakan:**
- Ketika Anda ingin **melihat dan mengedit perubahan sebelum commit ulang**
- Saat ingin **memisahkan satu commit menjadi beberapa commit terpisah**
- Ketika ingin membatalkan commit tetapi perubahan masih tersimpan di folder

---

### 3ï¸âƒ£ Mode `--hard` (Keras)

```
git reset --hard <hash>
```

**Apa yang terjadi:**
- âœï¸ HEAD pointer **dipindahkan** ke commit yang dituju
- ğŸ“¦ Staging Index **dikosongkan sepenuhnya**
- ğŸ“ **Working Directory direset sepenuhnya** - semua perubahan dari commit yang dibatalkan **HILANG SELAMANYA**

**Analogi:**
Seperti membakar tas dan semua barangnya (commit beserta perubahan). Tidak ada yang tersisa!

**âš ï¸ PERINGATAN:** Mode ini **sangat berbahaya**! Semua perubahan yang belum disimpan akan hilang selamanya. Gunakan dengan sangat hati-hati!

**Kapan digunakan:**
- Ketika Anda **100% yakin ingin menghapus semua perubahan**
- Saat ingin **kembali ke state repository tertentu sepenuhnya**

---

## ğŸ“Š Tabel Perbandingan Mode Reset

| Mode | HEAD Pointer | Staging Index | Working Directory | Perubahan Pergi Ke |
|------|:----:|:----:|:----:|-----------|
| **--soft** | âœ… Pindah | ğŸ“¦ **Ada** | âŒ Tetap | Staging Index (siap commit) |
| **--mixed** (default) | âœ… Pindah | âŒ Kosong | ğŸ“ **Ada** | Working Directory (perlu diedit) |
| **--hard** | âœ… Pindah | âŒ Kosong | âŒ Kosong | **HILANG SELAMANYA** âš ï¸ |

---

## ğŸ’» Contoh Penggunaan

### Melihat History Commit

Sebelum melakukan reset, kita perlu melihat history commit terlebih dahulu:

```bash
$ git log --oneline

b34dc9a (HEAD -> master) mengubah file2.txt menjadi file_2.txt
ae4a58c menghapus file3.txt
1b5f564 perubahan di file1.txt dan file2.txt
2118ac3 perubahan di file3.txt
59272c6 menambah file3.txt
4f15c9b menambah file2.txt
7453f5e Menambah file1.txt
```

**Penjelasan Output:**
- Setiap baris menunjukkan satu commit
- Hash (contoh: `b34dc9a`) adalah ID unik commit
- `(HEAD -> master)` menunjukkan posisi kita saat ini berada di branch master
- Teks setelah hash adalah pesan commit

---

### Contoh 1: Reset Soft â­

**Skenario:** Anda membuat commit dengan message yang salah dan ingin memperbaikinya

```bash
$ git log --oneline
b34dc9a (HEAD -> master) fix typo file2    â† Message salah!
ae4a58c menghapus file3.txt

# Batalkan commit dengan --soft
$ git reset --soft ae4a58c

# Sekarang lihat statusnya
$ git status

On branch master
Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
    renamed: file2.txt -> file_2.txt    â† Perubahan masih ada di staging!
```

**Yang terjadi step-by-step:**
1. âœ… HEAD pointer pindah dari `b34dc9a` ke `ae4a58c`
2. âœ… **Perubahan dari commit `b34dc9a` (rename file) dipindahkan ke Staging Index**
3. âœ… File di folder tetap seperti sebelumnya
4. âœ… Anda bisa sekarang membuat commit baru dengan message yang benar

**Contoh melanjutkan:**
```bash
# Lihat perubahan yang ada di staging
$ git diff --cached
# Output menunjukkan: file2.txt direname menjadi file_2.txt

# Sekarang commit dengan message yang benar
$ git commit -m "Rename file2.txt to file_2.txt karena standardisasi naming"

# Selesai! Commit baru dibuat dengan message yang benar
```

---

### Contoh 2: Reset Mixed ğŸ”§

**Skenario:** Anda ingin melihat perubahan yang dibuat sebelum commit ulang, atau memisahkan satu commit menjadi beberapa commit

```bash
$ git log --oneline
b34dc9a (HEAD -> master) perubahan besar (file1 dan file2)
ae4a58c menghapus file3.txt

# Batalkan commit dengan --mixed
$ git reset --mixed ae4a58c

Unstaged changes after reset:
M     file1.txt
M     file2.txt

# Sekarang lihat statusnya
$ git status

On branch master
Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
    modified: file1.txt
    modified: file2.txt

nothing added to commit but untracked files present (use "git add" to track)
```

**Yang terjadi step-by-step:**
1. âœ… HEAD pointer pindah dari `b34dc9a` ke `ae4a58c`
2. âœ… **Staging Index dikosongkan**
3. âœ… **Perubahan dari commit `b34dc9a` dipindahkan ke Working Directory**
4. âœ… Anda sekarang bisa melihat dan mengedit file-file tersebut di folder

**Contoh melanjutkan (memisahkan menjadi 2 commit):**
```bash
# Lihat perubahan yang ada di working directory
$ git diff
# Output menunjukkan: file1.txt diubah, file2.txt diubah

# Commit perubahan file1 terlebih dahulu
$ git add file1.txt
$ git commit -m "Perbaikan di file1.txt"

# Kemudian commit perubahan file2
$ git add file2.txt
$ git commit -m "Perbaikan di file2.txt"

# Selesai! Sekarang 1 commit besar terbagi menjadi 2 commit lebih kecil
```

---

### Contoh 3: Reset Hard âš ï¸ HATI-HATI!

**Skenario:** Anda membuat banyak kesalahan dan ingin kembali ke state repository yang lebih lama

```bash
$ git log --oneline
b34dc9a (HEAD -> master) kesalahan besar
a1f2e8c kesalahan lainnya
c3f8d2 perubahan yang bagus â† Ingin kembali ke sini

# Batalkan 2 commit terakhir dengan --hard
$ git reset --hard c3f8d2

HEAD is now at c3f8d2 perubahan yang bagus

# Sekarang lihat statusnya
$ git status

On branch master
nothing to commit, working tree clean
```

**Yang terjadi step-by-step:**
1. âœ… HEAD pointer pindah dari `b34dc9a` ke `c3f8d2`
2. âœ… Staging Index menjadi kosong
3. âœ… **Working Directory SEPENUHNYA direset - semua file kembali ke state commit `c3f8d2`**
4. âš ï¸ **Semua perubahan dari commit `b34dc9a` dan `a1f2e8c` HILANG SELAMANYA!**

**Verifikasi:**
```bash
$ git log --oneline
c3f8d2 (HEAD -> master) perubahan yang bagus
# Perhatikan: 2 commit terakhir sudah hilang dari history!
```

---

## ğŸ”„ Rewrite (Mengubah) Riwayat Commit

Saat Anda melakukan reset dan membuat commit baru, Anda sedang mengubah history commit:

### Jika Hanya Reset (Belum Commit Baru):
```
âœ… Commit lama masih tersimpan di reflog selama 30 hari
âœ… Anda masih bisa kembali dengan git reflog
```

### Jika Reset Lalu Membuat Commit Baru:
```
âš ï¸ Commit lama ditimpa oleh commit baru
âš ï¸ Lebih sulit untuk kembali ke commit lama
ğŸ“Œ Tapi masih bisa dengan git reflog dalam 30 hari
```

---

## âš¡ Tips dan Trik

âœ¨ **Sebelum melakukan reset, SELALU lakukan ini:**

1. **Backup dengan branch baru (opsional tapi aman):**
   ```bash
   git branch backup-branch  # Buat branch cadangan
   ```

2. **Lihat history commit:**
   ```bash
   git log --oneline
   ```

3. **Tentukan mode yang tepat:**
   - Ingin edit commit message? â†’ gunakan `--soft`
   - Ingin lihat perubahan dulu? â†’ gunakan `--mixed`
   - Ingin hapus semuanya? â†’ gunakan `--hard`

âœ¨ **Jika Anda melakukan kesalahan:**

```bash
# Lihat semua action yang pernah dilakukan
$ git reflog

# Jika ingin kembali ke commit tertentu
$ git reset --hard <hash>
```

---

## ğŸ“ Ringkasan Cepat

```
ğŸ¯ TUJUAN â†’ MODE YANG DIPILIH

Ingin edit commit message?
â†’ git reset --soft <hash>
  (perubahan di staging, siap di-commit ulang)

Ingin lihat & edit perubahan sebelum commit?
â†’ git reset --mixed <hash>  (atau hanya: git reset <hash>)
  (perubahan di working directory, perlu dicommit)

Ingin hapus semua dan kembali ke state lama?
â†’ git reset --hard <hash>
  (HATI-HATI! Perubahan hilang selamanya)
```

---

## ğŸ“Š Tabel Perbandingan Lengkap

| Aspek | --soft | --mixed | --hard |
|-------|--------|---------|--------|
| **Mengubah HEAD?** | âœ… Ya | âœ… Ya | âœ… Ya |
| **Perubahan ke mana?** | Staging | Working Dir | Hilang |
| **Selamat dari kesalahan?** | âœ… Ya (di staging) | âœ… Ya (di folder) | âŒ Tidak |
| **Keamanan** | â­â­â­ Aman | â­â­â­ Aman | â­ Sangat Risiko |
| **Berguna untuk** | Edit message | Edit perubahan | Hapus semua |

---

Dengan memahami ketiga mode reset ini, Anda dapat dengan percaya diri mengelola history commit di Git! ğŸš€

**Selamat belajar dan jangan takut untuk bereksperimen (dengan backup)!** ğŸ’ª
